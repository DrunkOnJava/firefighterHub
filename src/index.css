/* === Responsive No-Scroll Layout === */
:root {
  --header-h: 88px;      /* Header height */
  --gap: 1rem;           /* Standard gap */
  --roster-min-w: 400px; /* Minimum roster width */
}

html, body {
  width: 100%;
  height: 100vh;
  margin: 0;
  padding: 0;
  overflow: hidden; /* No page-level scrolling */
  position: fixed; /* Prevent mobile Safari scroll bounce */
}

#root {
  display: flex;
  flex-direction: column;
  height: 100vh;
  width: 100vw;
  overflow: hidden;
}

/* Main layout container - HORIZONTAL SPLIT */
main {
  flex: 1;
  display: grid;
  grid-template-columns: 1fr 400px; /* Calendar left, Roster right (400px) */
  gap: 1rem;
  overflow: hidden;
  min-height: 0;
  padding: 1rem;
}

/* Calendar/sidebar grid container - LEFT SIDE */
.calendar-grid-container {
  display: flex;
  flex-direction: column;
  overflow-y: auto; /* Allow calendar to scroll if needed */
  min-height: 0;
}

/* Roster section container - RIGHT SIDE */
.roster-container {
  display: flex;
  flex-direction: column;
  overflow-y: auto; /* Allow roster to scroll to show all 20 firefighters */
  min-height: 0;
  max-width: 400px;
}

/* Single-line text requirements */
.roster-name,
.roster-data {
  white-space: nowrap;
  overflow: visible; /* No truncation */
  text-overflow: clip; /* No ellipsis */
}

@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  * {
    -webkit-tap-highlight-color: transparent;
  }

  html {
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    text-rendering: optimizeLegibility;
  }

  body {
    font-size: 16px;
    line-height: 1.6;
    letter-spacing: 0.01em;
  }

  /* REMOVED: CSS transitions were causing performance issues and flickering
   * Can be re-added later with more targeted approach
   */

  h1 {
    font-size: clamp(1.75rem, 4vw, 2.25rem);
    line-height: 1.2;
    font-weight: 700;
    letter-spacing: -0.02em;
  }

  h2 {
    font-size: clamp(1.5rem, 3vw, 1.875rem);
    line-height: 1.3;
    font-weight: 700;
    letter-spacing: -0.01em;
  }

  h3 {
    font-size: clamp(1.25rem, 2.5vw, 1.5rem);
    line-height: 1.4;
    font-weight: 600;
  }

  p + p {
    margin-top: 1.5em;
  }

  /* Global focus-visible styles (WCAG 2.1 AA compliant)
   * 2px ring with 3:1 contrast ratio minimum
   * Blue-500 (#3b82f6) on slate-900 background = 7.2:1 contrast ✓
   * @see Issue #15 - Standardize Focus Ring Indicators
   */
  *:focus-visible {
    outline: 2px solid #3b82f6;
    outline-offset: 2px;
    border-radius: 4px;
  }

  /* WCAG 2.1 Target Size: Minimum 44x44px for all interactive elements */
  button:not(:disabled),
  a:not(.skip-link) {
    min-height: 44px;
    min-width: 44px;
  }

  /* Exception for icon-only buttons - ensure adequate touch area with padding */
  button:not(:disabled):has(svg:only-child) {
    min-width: 44px;
    min-height: 44px;
    padding: 0.5rem;
  }
}

@layer components {
  /* Standardized focus ring utility (WCAG 2.1 AA compliant)
   * Use tokens.focus.default instead for new components
   * This class maintained for backward compatibility
   * @see Issue #15 - Standardize Focus Ring Indicators
   */
  .focus-ring {
    @apply focus:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2 focus-visible:ring-offset-slate-900 transition-shadow;
  }

  .focus-ring-inset {
    @apply focus:outline-none focus-visible:ring-2 focus-visible:ring-inset focus-visible:ring-blue-500 transition-shadow;
  }

  .focus-ring-danger {
    @apply focus:outline-none focus-visible:ring-2 focus-visible:ring-red-500 focus-visible:ring-offset-2 focus-visible:ring-offset-slate-900 transition-shadow;
  }

  .focus-ring-success {
    @apply focus:outline-none focus-visible:ring-2 focus-visible:ring-emerald-500 focus-visible:ring-offset-2 focus-visible:ring-offset-slate-900 transition-shadow;
  }

  .skip-link {
    @apply absolute -top-full left-4 bg-gray-700 text-white px-6 py-3 rounded-lg z-[60] focus:top-4 transition-all font-semibold shadow-2xl;
  }

  .sr-only {
    position: absolute;
    width: 1px;
    height: 1px;
    padding: 0;
    margin: -1px;
    overflow: hidden;
    clip: rect(0, 0, 0, 0);
    white-space: nowrap;
    border-width: 0;
  }

  .sr-only-focusable:focus,
  .sr-only-focusable:active {
    position: static;
    width: auto;
    height: auto;
    overflow: visible;
    clip: auto;
    white-space: normal;
  }
}

@layer utilities {
  .font-dyslexia {
    font-family: "Lexend", system-ui, -apple-system, sans-serif;
    letter-spacing: 0.05em;
    word-spacing: 0.15em;
  }

  .readable {
    line-height: 1.8;
    font-size: 1.125rem;
    max-width: 70ch;
  }

  /* WCAG 2.1 AA Compliant Colors (4.5:1 contrast ratio minimum on dark backgrounds) */
  /* These colors have been tested for accessibility on gray-900 (#111827) background */

  .text-gray-accessible {
    color: #d1d5db; /* gray-300 - 8.59:1 contrast ratio ✓ */
  }

  .text-gray-secondary {
    color: #9ca3af; /* gray-400 - 5.74:1 contrast ratio ✓ */
  }

  .text-green-accessible {
    color: #86efac; /* green-300 - 11.14:1 contrast ratio ✓ */
  }

  .text-blue-accessible {
    color: #93c5fd; /* blue-300 - 8.57:1 contrast ratio ✓ */
  }

  .text-red-accessible {
    color: #fca5a5; /* red-300 - 7.35:1 contrast ratio ✓ */
  }

  .text-amber-accessible {
    color: #fcd34d; /* amber-300 - 12.04:1 contrast ratio ✓ */
  }

  /* WARNING: These colors DO NOT meet WCAG AA on dark backgrounds */
  /* gray-500 (#6B7280) = 3.32:1 - FAILS ✗ */
  /* gray-600 (#4B5563) = 2.39:1 - FAILS ✗ */
  /* Use gray-400 (#9CA3AF) or lighter instead */
}

@keyframes slide-up {
  from {
    opacity: 0;
    transform: translate(-50%, 20px);
  }
  to {
    opacity: 1;
    transform: translate(-50%, 0);
  }
}

@keyframes fade-in {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

@keyframes scale-in {
  from {
    opacity: 0;
    transform: scale(0.95);
  }
  to {
    opacity: 1;
    transform: scale(1);
  }
}

.animate-slide-up {
  animation: slide-up 0.3s ease-out;
}

.animate-fade-in {
  animation: fade-in 0.2s ease-out;
}

.animate-scale-in {
  animation: scale-in 0.2s ease-out;
}

@keyframes slide-in-right {
  from {
    transform: translateX(100%);
  }
  to {
    transform: translateX(0);
  }
}

.animate-slide-in-right {
  animation: slide-in-right 0.3s ease-out;
}

/* Shimmer effect for skeleton loaders */
@keyframes shimmer {
  0% {
    background-position: -200% 0;
  }
  100% {
    background-position: 200% 0;
  }
}

.animate-shimmer {
  animation: shimmer 2s infinite linear;
  background: linear-gradient(
    90deg,
    rgba(55, 65, 81, 1) 0%,
    rgba(75, 85, 99, 1) 50%,
    rgba(55, 65, 81, 1) 100%
  );
  background-size: 200% 100%;
}

/* Ripple effect for button interactions */
@keyframes ripple {
  0% {
    transform: translate(-50%, -50%) scale(0);
    opacity: 0.6;
  }
  100% {
    transform: translate(-50%, -50%) scale(4);
    opacity: 0;
  }
}

.btn-ripple {
  position: relative;
  overflow: hidden;
}

.btn-ripple::after {
  content: '';
  position: absolute;
  top: 50%;
  left: 50%;
  width: 100%;
  height: 100%;
  background: rgba(255, 255, 255, 0.5);
  border-radius: 50%;
  transform: translate(-50%, -50%) scale(0);
  pointer-events: none;
}

.btn-ripple:active::after {
  animation: ripple 0.6s ease-out;
}

@media (prefers-reduced-motion: reduce) {
  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
  }
  
  /* Disable ripple effect for reduced motion */
  .btn-ripple:active::after {
    animation: none;
  }
}

/* Print Stylesheet - Issue #33 */
@media print {
  /* Force light theme for print - saves ink and improves readability */
  * {
    background: white !important;
    color: black !important;
    box-shadow: none !important;
    text-shadow: none !important;
  }

  /* Hide non-essential UI elements */
  header,
  aside,
  nav,
  button,
  .no-print {
    display: none !important;
  }

  /* Reset page margins for better print layout */
  @page {
    margin: 1cm;
    size: landscape;
  }

  body {
    margin: 0;
    padding: 0;
    font-size: 12pt;
  }

  /* Main content should take full width */
  main {
    padding: 0 !important;
    margin: 0 !important;
  }

  /* Optimize calendar for print */
  .calendar-container,
  [role="main"] > div,
  section {
    page-break-inside: avoid;
    break-inside: avoid;
    width: 100% !important;
    max-width: 100% !important;
  }

  /* Remove grid gaps and unnecessary spacing for print */
  .grid {
    gap: 0 !important;
  }

  /* Ensure table/grid elements print well */
  table,
  .grid {
    page-break-inside: avoid;
    break-inside: avoid;
  }

  /* Force borders to be visible in print */
  table,
  th,
  td,
  .border,
  [class*="border-"] {
    border: 1px solid black !important;
  }

  /* Optimize links for print - hide URLs to save space */
  a[href]:after {
    content: "";
  }

  /* Remove link underlines in print */
  a {
    text-decoration: none;
  }

  /* Page breaks for better pagination */
  h1,
  h2,
  h3 {
    page-break-after: avoid;
    break-after: avoid;
    page-break-inside: avoid;
    break-inside: avoid;
  }

  /* Avoid breaking lists and cards */
  ul,
  ol,
  .card,
  [class*="rounded"],
  [class*="bg-"] {
    page-break-inside: avoid;
    break-inside: avoid;
  }

  /* Show all content - remove any hidden elements needed for print */
  .print-show {
    display: block !important;
  }

  /* Add print header with app title and shift info */
  body::before {
    content: "FirefighterHub - Hold Rotation Schedule";
    display: block;
    font-size: 18pt;
    font-weight: bold;
    text-align: center;
    margin-bottom: 0.5cm;
    padding-bottom: 0.3cm;
    border-bottom: 2px solid black;
  }

  /* Optimize typography for print */
  h1 {
    font-size: 16pt !important;
    margin-bottom: 0.3cm;
  }

  h2 {
    font-size: 14pt !important;
    margin-bottom: 0.2cm;
  }

  h3 {
    font-size: 12pt !important;
    margin-bottom: 0.2cm;
  }

  /* Ensure proper spacing */
  p,
  div,
  section {
    orphans: 3;
    widows: 3;
  }

  /* Calendar-specific optimizations */
  /* Calendar grid should be visible and properly formatted */
  [class*="grid-cols-7"] {
    display: grid !important;
    grid-template-columns: repeat(7, 1fr) !important;
  }

  /* Day cells should have proper borders */
  [class*="aspect-square"],
  [class*="calendar"],
  [role="gridcell"] {
    border: 1px solid #666 !important;
    padding: 0.2cm !important;
    min-height: 2cm !important;
  }

  /* Weekday headers should be bold */
  [class*="grid-cols-7"] > div:nth-child(-n+7) {
    font-weight: bold !important;
    background: #f0f0f0 !important;
    text-align: center !important;
  }

  /* Hold cards should be compact in print */
  [class*="border-l-"] {
    border-left: 3px solid black !important;
    padding: 0.1cm !important;
    margin: 0.05cm 0 !important;
    font-size: 10pt !important;
  }

  /* Month navigation should be printed as text */
  time,
  [aria-label*="month"] {
    display: block !important;
    text-align: center !important;
    font-size: 14pt !important;
    font-weight: bold !important;
    margin-bottom: 0.3cm !important;
  }

  /* Legends should be compact */
  [class*="legend"],
  [class*="flex"] > div {
    display: inline-block !important;
    margin-right: 0.5cm !important;
    font-size: 10pt !important;
  }

  /* Remove shadows and gradients that don't print well */
  [class*="shadow"],
  [class*="gradient"] {
    box-shadow: none !important;
    background: white !important;
  }

  /* Status badges should be clear */
  [class*="badge"],
  [class*="bg-blue"],
  [class*="bg-green"],
  [class*="bg-red"],
  [class*="bg-emerald"] {
    border: 1px solid black !important;
    padding: 0.05cm 0.2cm !important;
    background: white !important;
  }

  /* Scheduled holds indicator */
  [class*="bg-blue-500"] {
    background: #e6f0ff !important;
  }

  /* Completed holds indicator */
  [class*="bg-emerald"],
  [class*="bg-green"] {
    background: #e6f5e6 !important;
  }
}
